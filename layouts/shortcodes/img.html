{{- $src := .Get 0 -}}
{{- $alt := .Get 1 -}}

{{- if or (hasPrefix $src "http://") (hasPrefix $src "https://") -}}
  {{/* ì™¸ë¶€ URLì¸ ê²½ìš° ê·¸ëŒ€ë¡œ ì‚¬ìš© */}}
  <img src="{{ $src }}" alt="{{ $alt }}" loading="lazy">
{{- else -}}
  {{/* ë¡œì»¬ ì´ë¯¸ì§€ì¸ ê²½ìš° Page Bundleì—ì„œ ê°€ì ¸ì˜¤ê¸° */}}
  {{- with .Page.Resources.GetMatch $src -}}
    {{- $image := . -}}

    {{/* ì›ë³¸ì´ 1200pxë³´ë‹¤ í¬ë©´ ë¦¬ì‚¬ì´ì¦ˆ */}}
    {{- $resized := $image -}}
    {{- if gt $image.Width 1200 -}}
      {{- $resized = $image.Resize "1200x" -}}
    {{- end -}}

    {{/* WebP í˜•ì‹ìœ¼ë¡œ ë³€í™˜ (ìš©ëŸ‰ 30-40% ê°ì†Œ) */}}
    {{- $webp := $resized.Format "webp" -}}

    <figure>
      <img src="{{ $webp.RelPermalink }}"
           alt="{{ $alt }}"
           width="{{ $webp.Width }}"
           height="{{ $webp.Height }}"
           loading="lazy">
      {{- if $alt -}}
      <figcaption>{{ $alt }}</figcaption>
      {{- end -}}
    </figure>
  {{- else -}}
    <p style="color:red;">âŒ ì´ë¯¸ì§€ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤: {{ $src }}</p>
    <p style="color:orange;">ğŸ’¡ ê°™ì€ í´ë”ì— {{ $src }} íŒŒì¼ì´ ìˆëŠ”ì§€ í™•ì¸í•˜ì„¸ìš”.</p>
  {{- end -}}
{{- end -}}
